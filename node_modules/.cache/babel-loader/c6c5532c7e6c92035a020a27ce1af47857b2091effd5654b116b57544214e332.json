{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CCTalkParser = void 0;\nconst stream_1 = require(\"stream\");\n/**\n * Parse the CCTalk protocol\n * @extends Transform\n *\n * A transform stream that emits CCTalk packets as they are received.\n */\nclass CCTalkParser extends stream_1.Transform {\n  array;\n  cursor;\n  lastByteFetchTime;\n  maxDelayBetweenBytesMs;\n  constructor(maxDelayBetweenBytesMs = 50) {\n    super();\n    this.array = [];\n    this.cursor = 0;\n    this.lastByteFetchTime = 0;\n    this.maxDelayBetweenBytesMs = maxDelayBetweenBytesMs;\n  }\n  _transform(buffer, encoding, cb) {\n    if (this.maxDelayBetweenBytesMs > 0) {\n      const now = Date.now();\n      if (now - this.lastByteFetchTime > this.maxDelayBetweenBytesMs) {\n        this.array = [];\n        this.cursor = 0;\n      }\n      this.lastByteFetchTime = now;\n    }\n    this.cursor += buffer.length;\n    // TODO: Better Faster es7 no supported by node 4\n    // ES7 allows directly push [...buffer]\n    // this.array = this.array.concat(Array.from(buffer)) //Slower ?!?\n    Array.from(buffer).map(byte => this.array.push(byte));\n    while (this.cursor > 1 && this.cursor >= this.array[1] + 5) {\n      // full frame accumulated\n      // copy command from the array\n      const FullMsgLength = this.array[1] + 5;\n      const frame = Buffer.from(this.array.slice(0, FullMsgLength));\n      // Preserve Extra Data\n      this.array = this.array.slice(frame.length, this.array.length);\n      this.cursor -= FullMsgLength;\n      this.push(frame);\n    }\n    cb();\n  }\n}\nexports.CCTalkParser = CCTalkParser;","map":{"version":3,"names":["Object","defineProperty","exports","value","CCTalkParser","stream_1","require","Transform","array","cursor","lastByteFetchTime","maxDelayBetweenBytesMs","constructor","_transform","buffer","encoding","cb","now","Date","length","Array","from","map","byte","push","FullMsgLength","frame","Buffer","slice"],"sources":["/Users/kimdoyeon/Desktop/CapstonDesign1/node_modules/@serialport/parser-cctalk/dist/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CCTalkParser = void 0;\nconst stream_1 = require(\"stream\");\n/**\n * Parse the CCTalk protocol\n * @extends Transform\n *\n * A transform stream that emits CCTalk packets as they are received.\n */\nclass CCTalkParser extends stream_1.Transform {\n    array;\n    cursor;\n    lastByteFetchTime;\n    maxDelayBetweenBytesMs;\n    constructor(maxDelayBetweenBytesMs = 50) {\n        super();\n        this.array = [];\n        this.cursor = 0;\n        this.lastByteFetchTime = 0;\n        this.maxDelayBetweenBytesMs = maxDelayBetweenBytesMs;\n    }\n    _transform(buffer, encoding, cb) {\n        if (this.maxDelayBetweenBytesMs > 0) {\n            const now = Date.now();\n            if (now - this.lastByteFetchTime > this.maxDelayBetweenBytesMs) {\n                this.array = [];\n                this.cursor = 0;\n            }\n            this.lastByteFetchTime = now;\n        }\n        this.cursor += buffer.length;\n        // TODO: Better Faster es7 no supported by node 4\n        // ES7 allows directly push [...buffer]\n        // this.array = this.array.concat(Array.from(buffer)) //Slower ?!?\n        Array.from(buffer).map(byte => this.array.push(byte));\n        while (this.cursor > 1 && this.cursor >= this.array[1] + 5) {\n            // full frame accumulated\n            // copy command from the array\n            const FullMsgLength = this.array[1] + 5;\n            const frame = Buffer.from(this.array.slice(0, FullMsgLength));\n            // Preserve Extra Data\n            this.array = this.array.slice(frame.length, this.array.length);\n            this.cursor -= FullMsgLength;\n            this.push(frame);\n        }\n        cb();\n    }\n}\nexports.CCTalkParser = CCTalkParser;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,YAAY,GAAG,KAAK,CAAC;AAC7B,MAAMC,QAAQ,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,MAAMF,YAAY,SAASC,QAAQ,CAACE,SAAS,CAAC;EAC1CC,KAAK;EACLC,MAAM;EACNC,iBAAiB;EACjBC,sBAAsB;EACtBC,WAAWA,CAACD,sBAAsB,GAAG,EAAE,EAAE;IACrC,KAAK,CAAC,CAAC;IACP,IAAI,CAACH,KAAK,GAAG,EAAE;IACf,IAAI,CAACC,MAAM,GAAG,CAAC;IACf,IAAI,CAACC,iBAAiB,GAAG,CAAC;IAC1B,IAAI,CAACC,sBAAsB,GAAGA,sBAAsB;EACxD;EACAE,UAAUA,CAACC,MAAM,EAAEC,QAAQ,EAAEC,EAAE,EAAE;IAC7B,IAAI,IAAI,CAACL,sBAAsB,GAAG,CAAC,EAAE;MACjC,MAAMM,GAAG,GAAGC,IAAI,CAACD,GAAG,CAAC,CAAC;MACtB,IAAIA,GAAG,GAAG,IAAI,CAACP,iBAAiB,GAAG,IAAI,CAACC,sBAAsB,EAAE;QAC5D,IAAI,CAACH,KAAK,GAAG,EAAE;QACf,IAAI,CAACC,MAAM,GAAG,CAAC;MACnB;MACA,IAAI,CAACC,iBAAiB,GAAGO,GAAG;IAChC;IACA,IAAI,CAACR,MAAM,IAAIK,MAAM,CAACK,MAAM;IAC5B;IACA;IACA;IACAC,KAAK,CAACC,IAAI,CAACP,MAAM,CAAC,CAACQ,GAAG,CAACC,IAAI,IAAI,IAAI,CAACf,KAAK,CAACgB,IAAI,CAACD,IAAI,CAAC,CAAC;IACrD,OAAO,IAAI,CAACd,MAAM,GAAG,CAAC,IAAI,IAAI,CAACA,MAAM,IAAI,IAAI,CAACD,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;MACxD;MACA;MACA,MAAMiB,aAAa,GAAG,IAAI,CAACjB,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC;MACvC,MAAMkB,KAAK,GAAGC,MAAM,CAACN,IAAI,CAAC,IAAI,CAACb,KAAK,CAACoB,KAAK,CAAC,CAAC,EAAEH,aAAa,CAAC,CAAC;MAC7D;MACA,IAAI,CAACjB,KAAK,GAAG,IAAI,CAACA,KAAK,CAACoB,KAAK,CAACF,KAAK,CAACP,MAAM,EAAE,IAAI,CAACX,KAAK,CAACW,MAAM,CAAC;MAC9D,IAAI,CAACV,MAAM,IAAIgB,aAAa;MAC5B,IAAI,CAACD,IAAI,CAACE,KAAK,CAAC;IACpB;IACAV,EAAE,CAAC,CAAC;EACR;AACJ;AACAd,OAAO,CAACE,YAAY,GAAGA,YAAY"},"metadata":{},"sourceType":"script","externalDependencies":[]}